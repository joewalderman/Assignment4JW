??./.,.,.jmikiuio000000000000---
title: "a4task2jw"
author: "Joe Walderman"
date: "11/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(janitor)
library(lubridate)
library(here)
library(broom)
library(effsize)
```



## Introduction: A 4 - 5 sentence "mini-introduction" to what this study is exploring, including basic background information about the subject, site and study (with citations as needed), and a brief overview of what is included in the exploratory report. You should probably do this last.


## Data and Analysis:A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.

## Exploratory Findings: In this section I will be calculating juvenile hare trap counts for each year of the study.

### Step 1: Reading in the data

```{r}
hares <- read_csv(here("data", "bonanza_hares.csv"))
```

### Step 2:Data wrangling: Isolating hare trappings classified as juvenile and pulling the year of trapping for each observation from the date.

```{r}
hares_dates <- hares %>%
  mutate(date_new = mdy(date)) %>%
  mutate(year_new = year(date_new))

hares_j <- hares_dates %>% 
  filter(age == "j")

hares_j_yearly <- hares_j %>% 
  group_by(year_new) %>% 
  summarize(count = n())

hares_j$year_new <- as.factor(hares_j$year_new)
```

## Exploratory Findings


### i) Annual juvenile hare trap counts: In this section I evaluate the total number of trappings of juvenile hares for each year of the study, including a data visualization to illustrate this data.

```{r}
ggplot(data = hares_j_yearly, aes(x = year_new, y = count)) +
  geom_col() +
  labs(x = "Year",
       y = "Hares",
       title = "Annual Juvenile Hare Trappings in Bonanza Creek (1999-2012)",
       tag = "Figure 1: Number of juvenile showhow hares trapped each year in Bonanza Creek Experimental Forest from 1999-2012. These numbers were obtained in a study conducted by University of Alaska - Fairbanks.") +
  theme(plot.tag.position = "bottom",
        plot.tag = element_text(size = 5),
        plot.title = element_text(hjust = .5, size = 16))
```



### Part 4

```{r}
hares_j_sum <- hares_j_yearly %>% 
  summarize(mean_count = mean(count),
            median_count = median(count),
            minimum = min(count),
            maximum = max(count))

hares_j_sum
```

Some of the major takeaways from this graph is that the number of trappings declined after the first two years, though there are staggered upticks after a certain low amount is reached. Each rebound, though, is smaller every time it occurs.  Every time that the lowest trapping count for a year in this study was `mean(hares_j_stats$count)`... It seems that there has been an overall decline in the hare population in these areas based on these samples, with intermittent periods of recovery followed by decline. ] Another point of interest in the notable difference between the mean and median yearly hare trappings.

These are absolute counts, but this count is also impacted by effort (e.g. the number of days and number of traps in the study each year). What would you suggest be done moving forward (you are not expected to actually do this) to standardize the juvenile hare population in future analyses?


## ii) Visualize juvenile hare weights


```{r}
hares_j_sites <- hares_j %>% 
  mutate(grid_full = case_when(
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonbs" ~ "Bonanza Lowland"
  )) %>% 
  mutate(sex_full = case_when(
  sex == "f" ~ "Female",
  sex == "m" ~ "Male",
  sex == "NA" ~ "Unknown"
  ))
```


```{r}
ggplot(data = hares_j_sites, aes(x = sex_full, y = weight, fill = sex_full)) +
  geom_violin(position = "dodge", alpha = 0.7) +
  geom_boxplot(width = .1) +
  labs(
    x = "Sex",
    y = "Weight (grams)"
  ) +
  theme_light() +
  facet_wrap(~grid_full)
  
```

Then, in 2 - 3 sentences below your visualization(s) describe in text the main takeaways that you would want the audience to understand from your figures.

Males generally have a higher density of observations in higher weight recordings than females. The width of the plot represents the density of observations at that weight level. The boxplots indicate the sample sizes which can contribute to the vraince and the mean which can more easily illustrate the differences between the two.


## iii) Juvenile weight comparison (male and female snowshoe hares)


```{r}
hares_j_stat <- hares_j_sites %>%
  group_by(sex_full) %>% 
  summarize(mean_weight = mean(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm = TRUE),
            sample_size = n())

hares_j_stat
```

Table caption above the table


# t-test and cohen's d (effect size)

```{r}
hares_female <- hares_j_sites %>% 
  filter(sex_full == "Female") %>% 
  pull(weight)

hares_male <- hares_j_sites %>% 
  filter(sex_full == "Male") %>% 
  pull(weight)

actual_dif <- function(mean_1, mean_2) {mean_2 - mean_1}

actual_dif(mean(hares_female), mean(hares_male))

t.test(hares_female, hares_male)

cohen.d(hares_female, hares_male)
```

A 2 - 3 sentence comprehensive statement of the means comparison, including at least:
The actual difference in means
Effect size (Cohen's *d*)
Outcome of a two-sample t-test


## Exploratory graphs to explore assumptions of t-test

```{r}
ggplot(data = hares_j_sites, aes(x = weight)) + # *remember to include = FALSE*
  geom_histogram() +
  facet_wrap(~sex_full)

ggplot(data = hares_j_sites, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~sex_full)
```


Male seem less linear, distribution less normal.

The actual difference in mean weight between female and male snowshoe hares is ``. 

## iv) Relationships between juvenle weight and hind foot length


```{r}
ggplot(data = hares_j_sites, aes(x = hindft, y = weight)) +
  geom_point(size = 1.5) +  
  geom_smooth(method = "lm",
              color = "red",
              size = 0.5,
              fill = "gray10",
              alpha = 0.5) +
  labs(
    x = "Hind Foot Length (mm)",
    y = "Weight (g)",
    title = "Weight and Hind Foot Length in Juvenile Snowshow Hares",
    tag = "Figure 4: This graph explores the relationship between weight and hind food length in juvenile snowshoe hares captured in this study") +
      theme(plot.tag.position = "bottom",
        plot.tag = element_text(size = 6),
        plot.title = element_text(hjust = .5, size = 14))
```

I have some concerns here about the homoscedacisity of the relationship. It seems that the residuals are even up to about the 100mm hind foot length but beyond that the model seems to be heteroscedastic, as the distance of the residuals from the regression line increases.

## Linear Regression Model

```{r}
hares_j_lm <- lm(weight ~ hindft, data = hares_j_sites)

summary(hares_j_lm) #returning the complete overview
```

- hindft coefficient means we expect hare weight (g) to increase by 9.5234 grams for every 1 mm increase in hind foot lenth

- intercept means for a hare with 0mm hind foot length we expect a weight of -297.3419 grams.

- The Multiple R^2^ value is 0.2988 - meaning that 29.9% of variance in weight is explained by hind foot length


### Using broom package to tidy up my linear regression model results.

```{r}
hares_j_lm_tidy <- broom::tidy(hares_j_lm)

hares_j_lm_out <- broom::glance(hares_j_lm)
```

Simple linear regression was used to explore the relationship between hind foot length (mm) and weight (g).


```{r}
plot(hares_j_lm) # *remember to include = false*
```

### Pearson's r


```{r}
hares_j_cor <- cor.test(hares_j$hindft, hares_j$weight)

hares_j_cor
```

Here, we see that there is a strong positive correlation between penguin hindfoot length and weight(*r* = `r round(hares_j_cor$estimate,2)`, t(`r hares_j_cor$parameter`) = `r round(hares_j_cor$statistic,2)`, p < 0.001). 

I have some concerns here about the homoscedacisity of the relationship. It seems that the residuals are even up to about the 100mm hind foot length but beyond that the model seems to be heteroscedastic, as the distance of the residuals from the regression line increases.

In 2 - 3 sentences below your figure, describe the outcome of your linear regression exploration (e.g. slope interpretation, R2 value, and Pearson's r correlation) and touch briefly on which assumption(s) of linear regression may be a concern, and additional thoughts you have about how well (or not wellâ€¦) the linear model describes the relationship. What worries you?

## d) Summary: Summary: Include a very short summary describing your main findings from your juvenile hares exploration (bulletpoints are fine)



## e) Citations: Include citations (professionally formatted), including the data citation and any other resources that were references in your mini report. 